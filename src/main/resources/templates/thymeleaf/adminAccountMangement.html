<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect" />
    <link
      as="style"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Noto+Sans+KR%3Awght%40400%3B500%3B700%3B900&amp;family=Work+Sans%3Awght%40400%3B500%3B700%3B900"
      onload="this.rel='stylesheet'"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons|Material+Icons+Outlined"
      rel="stylesheet"
    />
    <title>CatDogEats 관리자 계정 관리</title>
    <link href="data:image/x-icon;base64," rel="icon" type="image/x-icon" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <style type="text/css">
      body {
        font-family: "Noto Sans KR", "Work Sans", sans-serif;
        background: linear-gradient(135deg, #faf8f5 0%, #f5f0e8 100%);
        min-height: 100vh;
      }

      .admin-container {
        background-color: white;
        border-radius: 1rem;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1),
          0 10px 10px -5px rgba(0, 0, 0, 0.04);
        border: 1px solid #f0ebe5;
        margin: 2rem auto;
        max-width: 1200px;
      }

      .primary-bg {
        background-color: #f5a623;
      }

      .primary-text {
        color: #f5a623;
      }

      .accent-text {
        color: #7d6e63;
      }

      .header-section {
        background: linear-gradient(135deg, #f5a623 0%, #e69500 100%);
        color: white;
        padding: 2rem;
        border-radius: 1rem 1rem 0 0;
      }

      .super-admin-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        background-color: rgba(255, 255, 255, 0.2);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 1.5rem;
        font-size: 0.75rem;
        font-weight: 600;
        margin-bottom: 1rem;
      }

      .content-section {
        padding: 2rem;
      }

      .toolbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        flex-wrap: wrap;
        gap: 1rem;
      }

      .search-box {
        display: flex;
        align-items: center;
        background-color: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 0.5rem;
        padding: 0.5rem 1rem;
        min-width: 300px;
        transition: border-color 0.2s ease-in-out;
      }

      .search-box:focus-within {
        border-color: #f5a623;
        box-shadow: 0 0 0 3px rgba(245, 166, 35, 0.1);
      }

      .search-input {
        background: transparent;
        border: none;
        outline: none;
        flex: 1;
        padding: 0.25rem 0.5rem;
        font-size: 0.875rem;
      }

      .btn {
        padding: 0.75rem 1.5rem;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease-in-out;
        border: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        text-decoration: none;
      }

      .btn-primary {
        background-color: #f5a623;
        color: white;
      }

      .btn-primary:hover {
        background-color: #e69500;
        transform: translateY(-1px);
      }

      .btn-secondary {
        background-color: white;
        color: #64748b;
        border: 1px solid #cbd5e1;
      }

      .btn-secondary:hover {
        background-color: #f8fafc;
        border-color: #94a3b8;
      }

      .btn-danger {
        background-color: #ef4444;
        color: white;
      }

      .btn-danger:hover {
        background-color: #dc2626;
      }

      .btn-success {
        background-color: #22c55e;
        color: white;
      }

      .btn-success:hover {
        background-color: #16a34a;
      }

      .btn-warning {
        background-color: #f59e0b;
        color: white;
      }

      .btn-warning:hover {
        background-color: #d97706;
      }

      .filter-tabs {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1.5rem;
        flex-wrap: wrap;
      }

      .filter-tab {
        padding: 0.5rem 1rem;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease-in-out;
        border: 1px solid #e2e8f0;
        background-color: white;
        color: #64748b;
      }

      .filter-tab.active {
        background-color: #f5a623;
        color: white;
        border-color: #f5a623;
      }

      .filter-tab:hover:not(.active) {
        background-color: #f8fafc;
        border-color: #cbd5e1;
      }

      .admin-table {
        width: 100%;
        border-collapse: collapse;
        background-color: white;
        border-radius: 0.75rem;
        overflow: hidden;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      }

      .admin-table th {
        background-color: #f8fafc;
        padding: 1rem;
        text-align: left;
        font-weight: 600;
        color: #374151;
        border-bottom: 1px solid #e5e7eb;
        font-size: 0.875rem;
      }

      .admin-table td {
        padding: 1rem;
        border-bottom: 1px solid #f3f4f6;
        font-size: 0.875rem;
        color: #4b5563;
      }

      .admin-table tbody tr:hover {
        background-color: #fefce8;
      }

      .admin-table tbody tr:last-child td {
        border-bottom: none;
      }

      .status-badge {
        display: inline-flex;
        align-items: center;
        padding: 0.25rem 0.75rem;
        border-radius: 1rem;
        font-size: 0.75rem;
        font-weight: 600;
        gap: 0.25rem;
      }

      .status-active {
        background-color: #dcfce7;
        color: #166534;
      }

      .status-inactive {
        background-color: #fee2e2;
        color: #991b1b;
      }

      .status-pending {
        background-color: #fef3c7;
        color: #92400e;
      }

      .role-badge {
        display: inline-flex;
        align-items: center;
        padding: 0.25rem 0.75rem;
        border-radius: 0.5rem;
        font-size: 0.75rem;
        font-weight: 600;
        gap: 0.25rem;
      }

      .role-super-admin {
        background-color: #ede9fe;
        color: #7c3aed;
      }

      .role-admin {
        background-color: #dbeafe;
        color: #1d4ed8;
      }

      .role-manager {
        background-color: #ecfdf5;
        color: #059669;
      }

      .action-buttons {
        display: flex;
        gap: 0.5rem;
        align-items: center;
      }

      .action-btn {
        padding: 0.5rem;
        border-radius: 0.375rem;
        border: none;
        cursor: pointer;
        transition: all 0.2s ease-in-out;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }

      .action-btn:hover {
        transform: scale(1.1);
      }

      .action-edit {
        background-color: #dbeafe;
        color: #1d4ed8;
      }

      .action-edit:hover {
        background-color: #bfdbfe;
      }

      .action-delete {
        background-color: #fee2e2;
        color: #dc2626;
      }

      .action-delete:hover {
        background-color: #fecaca;
      }

      .action-toggle {
        background-color: #f3f4f6;
        color: #6b7280;
      }

      .action-toggle:hover {
        background-color: #e5e7eb;
      }

      .pagination {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 0.5rem;
        margin-top: 2rem;
      }

      .pagination-btn {
        padding: 0.5rem 0.75rem;
        border: 1px solid #e5e7eb;
        background-color: white;
        color: #6b7280;
        border-radius: 0.375rem;
        cursor: pointer;
        transition: all 0.2s ease-in-out;
        font-size: 0.875rem;
      }

      .pagination-btn:hover:not(.disabled) {
        background-color: #f9fafb;
        border-color: #d1d5db;
      }

      .pagination-btn.active {
        background-color: #f5a623;
        color: white;
        border-color: #f5a623;
      }

      .pagination-btn.disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
      }

      .stat-card {
        background-color: white;
        padding: 1.5rem;
        border-radius: 0.75rem;
        border: 1px solid #e5e7eb;
        transition: all 0.2s ease-in-out;
      }

      .stat-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 16px -4px rgba(0, 0, 0, 0.1);
      }

      .stat-icon {
        width: 3rem;
        height: 3rem;
        border-radius: 0.75rem;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 1rem;
      }

      .stat-number {
        font-size: 2rem;
        font-weight: 700;
        color: #111827;
        margin-bottom: 0.5rem;
      }

      .stat-label {
        font-size: 0.875rem;
        color: #6b7280;
        font-weight: 500;
      }

      .empty-state {
        text-align: center;
        padding: 4rem 2rem;
        color: #6b7280;
      }

      .empty-icon {
        font-size: 4rem;
        color: #d1d5db;
        margin-bottom: 1rem;
      }

      /* 모달 스타일 */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 50;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
      }

      .modal-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      .modal-content {
        background-color: white;
        border-radius: 0.75rem;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        width: 90%;
        max-width: 500px;
        max-height: 90vh;
        overflow-y: auto;
        transform: scale(0.95) translateY(-20px);
        transition: transform 0.3s ease-in-out;
      }

      .modal-overlay.active .modal-content {
        transform: scale(1) translateY(0);
      }

      .modal-header {
        padding: 1.5rem;
        border-bottom: 1px solid #e5e7eb;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .modal-body {
        padding: 1.5rem;
      }

      .modal-footer {
        padding: 1.5rem;
        border-top: 1px solid #e5e7eb;
        display: flex;
        gap: 1rem;
        justify-content: flex-end;
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      .form-label {
        display: block;
        font-size: 0.875rem;
        font-weight: 600;
        color: #374151;
        margin-bottom: 0.5rem;
      }

      .form-label.required::after {
        content: " *";
        color: #ef4444;
      }

      .form-input {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid #d1d5db;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        transition: border-color 0.2s ease-in-out;
      }

      .form-input:focus {
        outline: none;
        border-color: #f5a623;
        box-shadow: 0 0 0 3px rgba(245, 166, 35, 0.1);
      }

      .form-select {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid #d1d5db;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        background-color: white;
        transition: border-color 0.2s ease-in-out;
      }

      .form-select:focus {
        outline: none;
        border-color: #f5a623;
        box-shadow: 0 0 0 3px rgba(245, 166, 35, 0.1);
      }

      .alert {
        padding: 1rem;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .alert-success {
        background-color: #dcfce7;
        color: #166534;
        border: 1px solid #bbf7d0;
      }

      .alert-error {
        background-color: #fee2e2;
        color: #991b1b;
        border: 1px solid #fecaca;
      }

      .alert-warning {
        background-color: #fef3c7;
        color: #92400e;
        border: 1px solid #fde68a;
      }

      /* 반응형 */
      @media (max-width: 768px) {
        .admin-container {
          margin: 1rem;
          border-radius: 0.75rem;
        }

        .header-section {
          padding: 1.5rem;
        }

        .content-section {
          padding: 1.5rem;
        }

        .toolbar {
          flex-direction: column;
          align-items: stretch;
        }

        .search-box {
          min-width: auto;
        }

        .admin-table {
          font-size: 0.75rem;
        }

        .admin-table th,
        .admin-table td {
          padding: 0.75rem 0.5rem;
        }

        .stats-grid {
          grid-template-columns: 1fr;
        }

        .action-buttons {
          flex-direction: column;
          gap: 0.25rem;
        }
      }

      @media (max-width: 640px) {
        .filter-tabs {
          overflow-x: auto;
          white-space: nowrap;
          padding-bottom: 0.5rem;
        }

        .admin-table thead {
          display: none;
        }

        .admin-table tbody tr {
          display: block;
          border: 1px solid #e5e7eb;
          border-radius: 0.5rem;
          margin-bottom: 1rem;
          padding: 1rem;
        }

        .admin-table tbody td {
          display: block;
          border-bottom: none;
          padding: 0.5rem 0;
          position: relative;
          padding-left: 40%;
        }

        .admin-table tbody td::before {
          content: attr(data-label);
          position: absolute;
          left: 0;
          width: 35%;
          font-weight: 600;
          color: #374151;
        }
      }
    </style>
  </head>
  <body>
    <div class="admin-container">
      <!-- 헤더 섹션 -->
      <div class="header-section">
        <div class="flex justify-between items-start">
          <div>
            <h1 class="text-3xl font-bold mb-2">관리자 계정 관리</h1>
            <p class="text-white/80">시스템 관리자 계정을 생성, 조회할 수 있습니다</p>
          </div>
          <div class="flex gap-2">
            <button onclick="goToDashboard()" class="btn btn-secondary" style="background-color: rgba(255,255,255,0.2); border-color: rgba(255,255,255,0.3); color: white;">
              <span class="material-icons-outlined text-sm">dashboard</span>
              대시보드
            </button>
          </div>
        </div>
      </div>

      <!-- 콘텐츠 섹션 -->
      <div class="content-section">
        <!-- 통계 카드 -->
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon" style="background-color: #dbeafe;">
              <span class="material-icons-outlined text-blue-600">group</span>
            </div>
            <div class="stat-number" id="totalAdmins">12</div>
            <div class="stat-label">전체 관리자</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon" style="background-color: #dcfce7;">
              <span class="material-icons-outlined text-green-600">check_circle</span>
            </div>
            <div class="stat-number" id="activeAdmins">10</div>
            <div class="stat-label">활성 계정</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon" style="background-color: #fef3c7;">
              <span class="material-icons-outlined text-yellow-600">schedule</span>
            </div>
            <div class="stat-number" id="pendingAdmins">2</div>
            <div class="stat-label">승인 대기</div>
          </div>

        </div>

        <!-- 알림 메시지 -->
        <div id="alertMessage" class="alert alert-success" style="display: none;">
          <span class="material-icons-outlined text-sm">check_circle</span>
          <span id="alertText">작업이 성공적으로 완료되었습니다.</span>
        </div>

        <!-- 툴바 -->
        <div class="toolbar">
          <div class="search-box">
            <span class="material-icons-outlined text-gray-400">search</span>
            <input 
              type="text" 
              class="search-input" 
              placeholder="이메일, 이름으로 검색..."
              id="searchInput"
              oninput="filterAdmins()"
            />
          </div>
          <div class="flex gap-2">
            <button onclick="showCreateModal()" class="btn btn-primary">
              <span class="material-icons-outlined text-sm">add</span>
              관리자 추가
            </button>
          </div>
        </div>

        <!-- 필터 탭 -->
        <div class="filter-tabs">
          <button class="filter-tab active" onclick="filterByStatus('all')" data-status="all">
            전체 (12)
          </button>
          <button class="filter-tab" onclick="filterByStatus('active')" data-status="active">
            활성 (10)
          </button>
          <button class="filter-tab" onclick="filterByStatus('pending')" data-status="pending">
            승인대기 (2)
          </button>
        </div>

        <!-- 관리자 테이블 -->
        <div style="overflow-x: auto;">
          <table class="admin-table">
            <thead>
              <tr>
                <th>관리자 정보</th>
                <th>부서</th>
                <th>상태</th>
                <th>등록일</th>
                <th>최종 로그인</th>
              </tr>
            </thead>
            <tbody id="adminTableBody">
              <!-- 관리자 목록이 여기에 동적으로 생성됩니다 -->
            </tbody>
          </table>
        </div>

        <!-- 빈 상태 -->
        <div id="emptyState" class="empty-state" style="display: none;">
          <div class="empty-icon">
            <span class="material-icons-outlined">search_off</span>
          </div>
          <h3 class="text-lg font-semibold mb-2">검색 결과가 없습니다</h3>
          <p class="text-sm">다른 검색어로 다시 시도해보세요</p>
        </div>

        <!-- 페이지네이션 -->
        <div class="pagination" id="pagination">
          <button class="pagination-btn disabled">
            <span class="material-icons-outlined text-sm">chevron_left</span>
          </button>
          <button class="pagination-btn active">1</button>
          <button class="pagination-btn">2</button>
          <button class="pagination-btn">3</button>
          <button class="pagination-btn">
            <span class="material-icons-outlined text-sm">chevron_right</span>
          </button>
        </div>
      </div>
    </div>

    <!-- 관리자 생성/수정 모달 -->
    <div id="adminModal" class="modal-overlay">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="text-lg font-semibold" id="modalTitle">관리자 추가</h3>
          <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600">
            <span class="material-icons-outlined">close</span>
          </button>
        </div>
        <form id="adminForm" onsubmit="handleSubmit(event)">
          <div class="modal-body">
            <input type="hidden" id="adminId" name="adminId" />
            
            <div class="form-group">
              <label class="form-label required" for="email">이메일</label>
              <input 
                type="email" 
                id="email" 
                name="email" 
                class="form-input" 
                required 
                placeholder="admin@catdogeats.com"
              />
            </div>

            <div class="form-group">
              <label class="form-label required" for="name">이름</label>
              <input 
                type="text" 
                id="name" 
                name="name" 
                class="form-input" 
                required 
                placeholder="홍길동"
              />
            </div>

            <div class="form-group">
              <label class="form-label required" for="department">부서</label>
              <select id="department" name="department" class="form-select" required>
                <option value="">부서를 선택하세요</option>
                <option value="DEVELOPMENT">개발팀</option>
                <option value="CUSTOMER_SERVICE">고객서비스팀</option>
                <option value="OPERATIONS">운영팀</option>
                <option value="ADMIN">관리팀</option>
              </select>
            </div>


            <div class="form-group" id="statusGroup" style="display: none;">
              <label class="form-label" for="status">상태</label>
              <select id="status" name="status" class="form-select">
                <option value="ACTIVE">활성</option>
                <option value="INACTIVE">비활성</option>
                <option value="PENDING">승인대기</option>
              </select>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" onclick="closeModal()" class="btn btn-secondary">
              취소
            </button>
            <button type="submit" class="btn btn-primary" id="submitBtn">
              <span class="material-icons-outlined text-sm">save</span>
              저장
            </button>
          </div>
        </form>
      </div>
    </div>

    <script>
      // 더미 관리자 데이터
      let admins = [
        {
          id: 1,
          name: '김슈퍼',
          email: 'super@catdogeats.com',
          department: 'ADMIN',
          status: 'ACTIVE',
          createdAt: '2024-01-15',
          lastLogin: '2024-06-15 14:30',
        },
        {
          id: 2,
          name: '박관리',
          email: 'admin1@catdogeats.com',
          department: 'DEVELOPMENT',
          status: 'ACTIVE',
          createdAt: '2024-02-01',
          lastLogin: '2024-06-14 09:15',
        },
        {
          id: 5,
          name: '정매니저',
          email: 'manager2@catdogeats.com',
          department: 'CUSTOMER_SERVICE',
          status: 'ACTIVE',
          createdAt: '2024-03-01',
          lastLogin: '2024-06-12 11:20',
        },
        {
          id: 6,
          name: '윤관리',
          email: 'admin3@catdogeats.com',
          department: 'OPERATIONS',
          status: 'ACTIVE',
          createdAt: '2024-03-15',
          lastLogin: '2024-06-11 08:30',
        },
        {
          id: 7,
          name: '강매니저',
          email: 'manager3@catdogeats.com',
          department: 'FINANCE',
          status: 'ACTIVE',
          createdAt: '2024-04-01',
          lastLogin: '2024-06-10 15:10',
          avatar: 'KM'
        },
        {
          id: 9,
          name: '신매니저',
          email: 'manager4@catdogeats.com',
          department: 'DEVELOPMENT',
          status: 'ACTIVE',
          createdAt: '2024-05-01',
          lastLogin: '2024-06-08 10:20',
        },
        {
          id: 11,
          name: '한매니저',
          email: 'manager5@catdogeats.com',
          department: 'ADMIN',
          status: 'PENDING',
          createdAt: '2024-06-01',
          lastLogin: '-',
        },
        {
          id: 13,
          name: '신매니저',
          email: 'manager4@catdogeats.com',
          department: 'DEVELOPMENT',
          status: 'ACTIVE',
          createdAt: '2024-05-01',
          lastLogin: '2024-06-08 10:20',
        },
        {
          id: 14,
          name: '신매니저',
          email: 'manager4@catdogeats.com',
          department: 'DEVELOPMENT',
          status: 'ACTIVE',
          createdAt: '2024-05-01',
          lastLogin: '2024-06-08 10:20',
        },
        {
          id: 15,
          name: '박관리',
          email: 'admin1@catdogeats.com',
          department: 'DEVELOPMENT',
          status: 'ACTIVE',
          createdAt: '2024-02-01',
          lastLogin: '2024-06-14 09:15',
        },
        {
          id: 16,
          name: '박관리',
          email: 'admin1@catdogeats.com',
          department: 'DEVELOPMENT',
          status: 'ACTIVE',
          createdAt: '2024-02-01',
          lastLogin: '2024-06-14 09:15',
        },
      ];

      let filteredAdmins = [...admins];
      let currentPage = 1;
      const itemsPerPage = 10;
      let currentFilter = 'all';
      let editingAdminId = null;

      // 페이지 로드 시 초기화
      document.addEventListener('DOMContentLoaded', function() {
        updateStats();
        renderAdmins();
        updateFilterTabs();
      });

      // 통계 업데이트
      function updateStats() {
        const total = admins.length;
        const active = admins.filter(a => a.status === 'ACTIVE').length;
        const pending = admins.filter(a => a.status === 'PENDING').length;
        const inactive = admins.filter(a => a.status === 'INACTIVE').length;

        document.getElementById('totalAdmins').textContent = total;
        document.getElementById('activeAdmins').textContent = active;
        document.getElementById('pendingAdmins').textContent = pending;
      }

      // 필터 탭 업데이트
      function updateFilterTabs() {
        const total = admins.length;
        const active = admins.filter(a => a.status === 'ACTIVE').length;
        const pending = admins.filter(a => a.status === 'PENDING').length;
        const inactive = admins.filter(a => a.status === 'INACTIVE').length;

        document.querySelector('[data-status="all"]').textContent = `전체 (${total})`;
        document.querySelector('[data-status="active"]').textContent = `활성 (${active})`;
        document.querySelector('[data-status="pending"]').textContent = `승인대기 (${pending})`;
      }

      // 관리자 목록 렌더링
      function renderAdmins() {
        const tbody = document.getElementById('adminTableBody');
        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;
        const pageAdmins = filteredAdmins.slice(startIndex, endIndex);

        if (pageAdmins.length === 0) {
          tbody.innerHTML = '';
          document.getElementById('emptyState').style.display = 'block';
          document.querySelector('.admin-table').style.display = 'none';
          return;
        }

        document.getElementById('emptyState').style.display = 'none';
        document.querySelector('.admin-table').style.display = 'table';

        tbody.innerHTML = pageAdmins.map(admin => `
          <tr>
            <td data-label="관리자 정보">
              <div class="flex items-center gap-3">

                <div>
                  <div class="font-semibold text-gray-900">${admin.name}</div>
                  <div class="text-gray-500 text-sm">${admin.email}</div>
                </div>
              </div>
            </td>
            <td data-label="부서">${getDepartmentName(admin.department)}</td>
            <td data-label="상태">
              <span class="status-badge ${getStatusClass(admin.status)}">
                <span class="material-icons-outlined text-xs">${getStatusIcon(admin.status)}</span>
                ${getStatusName(admin.status)}
              </span>
            </td>
            <td data-label="등록일">${formatDate(admin.createdAt)}</td>
            <td data-label="최종 로그인">${admin.lastLogin}</td>
          </tr>
        `).join('');

        renderPagination();
      }

      // 페이지네이션 렌더링
      function renderPagination() {
        const totalPages = Math.ceil(filteredAdmins.length / itemsPerPage);
        const pagination = document.getElementById('pagination');
        
        if (totalPages <= 1) {
          pagination.style.display = 'none';
          return;
        }

        pagination.style.display = 'flex';
        
        let paginationHTML = '';
        
        // 이전 버튼
        paginationHTML += `
          <button class="pagination-btn ${currentPage === 1 ? 'disabled' : ''}" onclick="goToPage(${currentPage - 1})">
            <span class="material-icons-outlined text-sm">chevron_left</span>
          </button>
        `;

        // 페이지 번호들
        const startPage = Math.max(1, currentPage - 2);
        const endPage = Math.min(totalPages, currentPage + 2);

        if (startPage > 1) {
          paginationHTML += `<button class="pagination-btn" onclick="goToPage(1)">1</button>`;
          if (startPage > 2) {
            paginationHTML += `<span class="pagination-btn disabled">...</span>`;
          }
        }

        for (let i = startPage; i <= endPage; i++) {
          paginationHTML += `
            <button class="pagination-btn ${currentPage === i ? 'active' : ''}" onclick="goToPage(${i})">
              ${i}
            </button>
          `;
        }

        if (endPage < totalPages) {
          if (endPage < totalPages - 1) {
            paginationHTML += `<span class="pagination-btn disabled">...</span>`;
          }
          paginationHTML += `<button class="pagination-btn" onclick="goToPage(${totalPages})">${totalPages}</button>`;
        }

        // 다음 버튼
        paginationHTML += `
          <button class="pagination-btn ${currentPage === totalPages ? 'disabled' : ''}" onclick="goToPage(${currentPage + 1})">
            <span class="material-icons-outlined text-sm">chevron_right</span>
          </button>
        `;

        pagination.innerHTML = paginationHTML;
      }

      // 페이지 이동
      function goToPage(page) {
        const totalPages = Math.ceil(filteredAdmins.length / itemsPerPage);
        if (page < 1 || page > totalPages) return;
        
        currentPage = page;
        renderAdmins();
      }

      // 상태별 필터링
      function filterByStatus(status) {
        currentFilter = status;
        currentPage = 1;

        // 탭 활성화 상태 변경
        document.querySelectorAll('.filter-tab').forEach(tab => {
          tab.classList.remove('active');
        });
        document.querySelector(`[data-status="${status}"]`).classList.add('active');

        // 필터링 적용
        if (status === 'all') {
          filteredAdmins = [...admins];
        } else {
          filteredAdmins = admins.filter(admin => admin.status.toLowerCase() === status);
        }

        // 검색어가 있으면 추가 필터링
        const searchTerm = document.getElementById('searchInput').value.trim();
        if (searchTerm) {
          filteredAdmins = filteredAdmins.filter(admin => 
            admin.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
            admin.email.toLowerCase().includes(searchTerm.toLowerCase())
          );
        }

        renderAdmins();
      }

      // 검색 필터링
      function filterAdmins() {
        const searchTerm = document.getElementById('searchInput').value.trim();
        currentPage = 1;

        // 상태 필터 먼저 적용
        if (currentFilter === 'all') {
          filteredAdmins = [...admins];
        } else {
          filteredAdmins = admins.filter(admin => admin.status.toLowerCase() === currentFilter);
        }

        // 검색어 필터링
        if (searchTerm) {
          filteredAdmins = filteredAdmins.filter(admin => 
            admin.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
            admin.email.toLowerCase().includes(searchTerm.toLowerCase())
          );
        }

        renderAdmins();
      }

      // 관리자 생성 모달 표시
      function showCreateModal() {
        editingAdminId = null;
        document.getElementById('modalTitle').textContent = '관리자 추가';
        document.getElementById('submitBtn').innerHTML = '<span class="material-icons-outlined text-sm">add</span> 추가';
        document.getElementById('statusGroup').style.display = 'none';
        document.getElementById('adminForm').reset();
        document.getElementById('adminModal').classList.add('active');
        document.body.style.overflow = 'hidden';
      }

      // 관리자 수정
      function editAdmin(id) {
        const admin = admins.find(a => a.id === id);
        if (!admin) return;

        editingAdminId = id;
        document.getElementById('modalTitle').textContent = '관리자 수정';
        document.getElementById('submitBtn').innerHTML = '<span class="material-icons-outlined text-sm">save</span> 저장';
        document.getElementById('statusGroup').style.display = 'block';

        // 폼에 데이터 채우기
        document.getElementById('adminId').value = admin.id;
        document.getElementById('email').value = admin.email;
        document.getElementById('name').value = admin.name;
        document.getElementById('department').value = admin.department;
        document.getElementById('role').value = admin.role;
        document.getElementById('status').value = admin.status;

        document.getElementById('adminModal').classList.add('active');
        document.body.style.overflow = 'hidden';
      }

      // 관리자 상태 토글
      function toggleAdminStatus(id) {
        const admin = admins.find(a => a.id === id);
        if (!admin) return;

        const newStatus = admin.status === 'ACTIVE' ? 'INACTIVE' : 'ACTIVE';
        admin.status = newStatus;

        showAlert(`${admin.name}님의 계정이 ${getStatusName(newStatus)}되었습니다.`, 'success');
        updateStats();
        updateFilterTabs();
        renderAdmins();
      }

      // 관리자 삭제
      function deleteAdmin(id) {
        const admin = admins.find(a => a.id === id);
        if (!admin) return;

        if (admin.role === 'SUPER_ADMIN') {
          showAlert('슈퍼관리자 계정은 삭제할 수 없습니다.', 'error');
          return;
        }

        document.getElementById('deleteAdminName').textContent = admin.name;
        document.getElementById('deleteAdminEmail').textContent = admin.email;
        document.getElementById('deleteModal').classList.add('active');
        document.getElementById('deleteModal').dataset.adminId = id;
        document.body.style.overflow = 'hidden';
      }

      // 삭제 확인
      function confirmDelete() {
        const id = parseInt(document.getElementById('deleteModal').dataset.adminId);
        const adminIndex = admins.findIndex(a => a.id === id);
        
        if (adminIndex > -1) {
          const deletedAdmin = admins[adminIndex];
          admins.splice(adminIndex, 1);
          
          // 필터링된 목록도 업데이트
          filterAdmins();
          
          showAlert(`${deletedAdmin.name}님의 계정이 삭제되었습니다.`, 'success');
          updateStats();
          updateFilterTabs();
        }

        closeDeleteModal();
      }

      // 폼 제출 처리
      function handleSubmit(event) {
        event.preventDefault();
        
        const formData = new FormData(event.target);
        const adminData = {
          name: formData.get('name'),
          email: formData.get('email'),
          department: formData.get('department'),
          role: formData.get('role'),
          status: formData.get('status') || 'PENDING'
        };

        if (editingAdminId) {
          // 수정
          const admin = admins.find(a => a.id === editingAdminId);
          if (admin) {
            Object.assign(admin, adminData);
            showAlert(`${admin.name}님의 정보가 업데이트되었습니다.`, 'success');
          }
        } else {
          // 추가
          const newAdmin = {
            id: Math.max(...admins.map(a => a.id)) + 1,
            ...adminData,
            createdAt: new Date().toISOString().split('T')[0],
            lastLogin: '-',
            avatar: adminData.name.substring(0, 2).toUpperCase()
          };
          admins.push(newAdmin);
          showAlert(`${newAdmin.name}님이 관리자로 추가되었습니다.`, 'success');
        }

        updateStats();
        updateFilterTabs();
        filterAdmins();
        closeModal();
      }

      // 모달 닫기
      function closeModal() {
        document.getElementById('adminModal').classList.remove('active');
        document.body.style.overflow = 'auto';
        document.getElementById('adminForm').reset();
        editingAdminId = null;
      }

      function closeDeleteModal() {
        document.getElementById('deleteModal').classList.remove('active');
        document.body.style.overflow = 'auto';
      }

      // 알림 표시
      function showAlert(message, type = 'success') {
        const alert = document.getElementById('alertMessage');
        const alertText = document.getElementById('alertText');
        
        alert.className = `alert alert-${type}`;
        alertText.textContent = message;
        alert.style.display = 'flex';

        setTimeout(() => {
          alert.style.display = 'none';
        }, 5000);
      }

      // 대시보드로 이동
      function goToDashboard() {
        window.location.href = '/admin/dashboard';
      }

      // 유틸리티 함수들
      function getDepartmentName(dept) {
        const names = {
          'DEVELOPMENT': '개발팀',
          'CUSTOMER_SERVICE': '고객서비스팀',
          'OPERATIONS': '운영팀',
          'FINANCE': '재무팀',
          'ADMIN': '관리팀'
        };
        return names[dept] || dept;
      }

      function getRoleName(role) {
        const names = {
          'SUPER_ADMIN': '슈퍼관리자',
          'ADMIN': '관리자',
          'MANAGER': '매니저'
        };
        return names[role] || role;
      }

      function getRoleClass(role) {
        const classes = {
          'SUPER_ADMIN': 'role-super-admin',
          'ADMIN': 'role-admin',
          'MANAGER': 'role-manager'
        };
        return classes[role] || '';
      }

      function getRoleIcon(role) {
        const icons = {
          'SUPER_ADMIN': 'verified_user',
          'ADMIN': 'admin_panel_settings',
          'MANAGER': 'supervisor_account'
        };
        return icons[role] || 'person';
      }

      function getStatusName(status) {
        const names = {
          'ACTIVE': '활성',
          'INACTIVE': '비활성',
          'PENDING': '승인대기'
        };
        return names[status] || status;
      }

      function getStatusClass(status) {
        const classes = {
          'ACTIVE': 'status-active',
          'INACTIVE': 'status-inactive',
          'PENDING': 'status-pending'
        };
        return classes[status] || '';
      }

      function getStatusIcon(status) {
        const icons = {
          'ACTIVE': 'check_circle',
          'INACTIVE': 'cancel',
          'PENDING': 'schedule'
        };
        return icons[status] || 'help';
      }

      function formatDate(dateString) {
        const date = new Date(dateString);
        return date.toLocaleDateString('ko-KR');
      }

      // 모달 외부 클릭 시 닫기
      document.addEventListener('click', function(e) {
        if (e.target.classList.contains('modal-overlay')) {
          if (e.target.id === 'adminModal') {
            closeModal();
          } else if (e.target.id === 'deleteModal') {
            closeDeleteModal();
          }
        }
      });

      // ESC 키로 모달 닫기
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          if (document.getElementById('adminModal').classList.contains('active')) {
            closeModal();
          } else if (document.getElementById('deleteModal').classList.contains('active')) {
            closeDeleteModal();
          }
        }
      });

      // 개발용 빠른 기능들 (localhost에서만)
      if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
        const devPanel = document.createElement('div');
        devPanel.style.cssText = `
          position: fixed; 
          top: 10px; 
          right: 10px; 
          background: rgba(0,0,0,0.8); 
          color: white; 
          padding: 10px; 
          border-radius: 8px; 
          font-size: 12px; 
          z-index: 1000;
          display: flex;
          flex-direction: column;
          gap: 5px;
        `;
        devPanel.innerHTML = `
          <div style="font-weight: bold; margin-bottom: 5px;">개발 도구</div>
          <button onclick="showCreateModal()" style="background: #f59e0b; color: white; border: none; padding: 4px 8px; border-radius: 4px; font-size: 11px; cursor: pointer;">관리자 추가</button>
          <button onclick="addDummyData()" style="background: #10b981; color: white; border: none; padding: 4px 8px; border-radius: 4px; font-size: 11px; cursor: pointer;">더미 데이터</button>
          <button onclick="resetData()" style="background: #ef4444; color: white; border: none; padding: 4px 8px; border-radius: 4px; font-size: 11px; cursor: pointer;">데이터 초기화</button>
        `;
        document.body.appendChild(devPanel);

        // 더미 데이터 추가 함수
        window.addDummyData = function() {
          const dummyAdmin = {
            id: Math.max(...admins.map(a => a.id)) + 1,
            name: '테스트관리자',
            email: `test${Date.now()}@catdogeats.com`,
            department: 'DEVELOPMENT',
            role: 'ADMIN',
            status: 'ACTIVE',
            createdAt: new Date().toISOString().split('T')[0],
            lastLogin: '방금 전',
            avatar: 'TE'
          };
          admins.push(dummyAdmin);
          updateStats();
          updateFilterTabs();
          filterAdmins();
          showAlert('더미 관리자가 추가되었습니다.', 'success');
        };

        // 데이터 초기화 함수
        window.resetData = function() {
          if (confirm('모든 데이터를 초기화하시겠습니까?')) {
            location.reload();
          }
        };
      }
    </script>
  </body>
</html>