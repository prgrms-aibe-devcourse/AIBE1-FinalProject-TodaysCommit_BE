<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect" />
    <link
            as="style"
            href="https://fonts.googleapis.com/css2?display=swap&amp;family=Noto+Sans+KR%3Awght%40400%3B500%3B700%3B900&amp;family=Work+Sans%3Awght%40400%3B500%3B700%3B900"
            onload="this.rel='stylesheet'"
            rel="stylesheet"
    />
    <link
            href="https://fonts.googleapis.com/icon?family=Material+Icons|Material+Icons+Outlined"
            rel="stylesheet"
    />
    <title>관리자 초대 - CatDogEats Admin</title>
    <link href="data:image/x-icon;base64," rel="icon" type="image/x-icon" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <!-- 관리자 공통 JavaScript -->
    <script>
        /**
         * 관리자 페이지 공통 JavaScript 함수들
         */
        let currentAdminInfo = null;

        async function getCurrentAdminInfo() {
            if (currentAdminInfo) return currentAdminInfo;
            try {
                const response = await fetch('/v1/admin/profile', {
                    method: 'GET',
                    headers: { 'X-Requested-With': 'XMLHttpRequest' }
                });
                if (response.ok) {
                    const result = await response.json();
                    if (result.success && result.data) {
                        currentAdminInfo = result.data;
                        return currentAdminInfo;
                    }
                }
            } catch (error) {
                console.error('관리자 정보 조회 중 오류:', error);
            }
            return null;
        }

        async function isAdminDepartment() {
            const adminInfo = await getCurrentAdminInfo();
            return adminInfo && adminInfo.department === 'ADMIN';
        }

        async function initializeSidebar() {
            const adminInfo = await getCurrentAdminInfo();
            if (!adminInfo) return;

            const adminOnlyMenus = ['inviteMenuItem', 'accountManagementMenuItem'];
            adminOnlyMenus.forEach(menuId => {
                const menuElement = document.getElementById(menuId);
                if (menuElement) {
                    if (adminInfo.department === 'ADMIN') {
                        menuElement.style.display = 'flex';
                        menuElement.classList.remove('disabled');
                    } else {
                        menuElement.style.display = 'none';
                    }
                }
            });

            setActivePage();
        }


        function setActivePage() {
            const currentPath = window.location.pathname;
            const allLinks = document.querySelectorAll('.sidebar-link');

            allLinks.forEach(link => {
                link.classList.remove('active-tab');
                link.classList.add('inactive-tab');
            });

            let activeLink = null;
            if (currentPath.includes('/dashboard')) {
                activeLink = document.querySelector('[data-page="dashboard"]');
            } else if (currentPath.includes('/account-management')) {
                activeLink = document.querySelector('[data-page="account-management"]');
            } else if (currentPath.includes('/invite')) {
                activeLink = document.querySelector('[data-page="invite"]');
            } else if (currentPath.includes('/settings')) {
                activeLink = document.querySelector('[data-page="settings"]');
            }

            if (activeLink) {
                activeLink.classList.remove('inactive-tab');
                activeLink.classList.add('active-tab');
            }
        }

        function showComingSoon(featureName) {
            alert(`${featureName} 기능은 현재 개발 중입니다. 곧 업데이트될 예정입니다.`);
        }




        async function checkPagePermission(requiredPermission) {
            const adminInfo = await getCurrentAdminInfo();
            if (!adminInfo) {
                window.location.href = '/v1/admin/login';
                return false;
            }
            if (requiredPermission === 'ADMIN_ONLY' && adminInfo.department !== 'ADMIN') {
                return false;
            }
            return true;
        }

        async function initializeAdminPage(pagePermission = 'ALL_ADMIN') {
            try {
                await initializeSidebar();
                const hasPermission = await checkPagePermission(pagePermission);
                return hasPermission;
            } catch (error) {
                console.error('페이지 초기화 중 오류:', error);
                return false;
            }
        }
    </script>
    <style type="text/css">
        body {
            font-family: "Noto Sans KR", "Work Sans", sans-serif;
            background-color: #faf8f5;
        }
        .primary-bg {
            background-color: #f5a623;
        }
        .primary-text {
            color: #f5a623;
        }
        .accent-text {
            color: #7d6e63;
        }

        .sidebar {
            background-color: #fffdfb;
            border-right: 1px solid #f0ebe5;
        }
        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: #7d6e63;
            margin-bottom: 0.5rem;
        }
        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #cbd5e1;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            color: #374151;
            background-color: white;
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .form-input:focus {
            outline: none;
            border-color: #f5a623;
            box-shadow: 0 0 0 3px rgba(245, 166, 35, 0.1);
        }
        .form-select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #cbd5e1;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            color: #374151;
            background-color: white;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }


        .sidebar-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.625rem 0.75rem;
            border-radius: 0.375rem;
            text-decoration: none;
            transition: all 0.2s ease-in-out;
            position: relative;
            border-left: 4px solid transparent;
        }

        .sidebar-link.disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        .sidebar-link.disabled:hover {
            background-color: transparent !important;
        }

        .coming-soon-badge {
            position: absolute;
            right: 0.5rem;
            top: 50%;
            transform: translateY(-50%);
            background-color: #fbbf24;
            color: white;
            font-size: 0.625rem;
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            font-weight: 600;
        }

        .active-tab {
            border-left-color: #f5a623;
            background-color: #fff9f0;
            color: #f5a623;
            font-weight: 700;
        }
        .inactive-tab {
            border-left-color: transparent;
            color: #7d6e63;
            font-weight: 500;
        }
        .inactive-tab:hover:not(.disabled) {
            background-color: #fdfbf8;
            color: #e69500;
        }
        .inactive-tab:hover:not(.disabled) .sidebar-link-icon,
        .inactive-tab:hover:not(.disabled) .sidebar-link-text {
            color: #e69500;
        }

        .sidebar-link-icon {
            color: #bcaaa4;
        }
        .sidebar-link-text {
            color: #7d6e63;
        }
        .active-tab .sidebar-link-icon,
        .active-tab .sidebar-link-text {
            color: #f5a623;
        }


        .form-select:focus {
            outline: none;
            border-color: #f5a623;
            box-shadow: 0 0 0 3px rgba(245, 166, 35, 0.1);
        }
        .invite-button {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 0.875rem;
            background-color: #f5a623;
            color: white;
            border: none;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
        }
        .invite-button:hover {
            background-color: #e69500;
            transform: translateY(-1px);
        }
        .invite-button:disabled {
            background-color: #cbd5e1;
            cursor: not-allowed;
            transform: none;
        }
        .back-button {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 0.75rem;
            background-color: #f8fafc;
            color: #374151;
            border: 1px solid #cbd5e1;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            text-decoration: none;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
        }
        .back-button:hover {
            background-color: #f1f5f9;
            border-color: #94a3b8;
            color: #374151;
            text-decoration: none;
        }
        .invite-card {
            background-color: white;
            border: 1px solid #f0ebe5;
            border-radius: 0.75rem;
            padding: 2.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            margin: 0 auto;
        }
        .alert {
            padding: 0.75rem 1rem;
            margin-bottom: 1rem;
            border-radius: 0.5rem;
            border: 1px solid;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .alert-success {
            background-color: #dcfce7;
            border-color: #bbf7d0;
            color: #15803d;
        }
        .alert-error {
            background-color: #fee2e2;
            border-color: #fecaca;
            color: #dc2626;
        }
        .loading-spinner {
            display: none;
            width: 1rem;
            height: 1rem;
            border: 2px solid transparent;
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .user-menu {
            position: relative;
            display: inline-block;
        }
        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background-color: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            min-width: 200px;
            z-index: 50;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out, transform 0.2s ease-in-out;
        }
        .user-dropdown.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        .dropdown-item {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            color: #374151;
            text-decoration: none;
            font-size: 0.875rem;
            transition: background-color 0.15s ease-in-out;
        }
        .dropdown-item:hover {
            background-color: #f9fafb;
            color: #111827;
            text-decoration: none;
        }
        .dropdown-item.danger {
            color: #dc2626;
        }
        .dropdown-item.danger:hover {
            background-color: #fef2f2;
            color: #b91c1c;
        }
    </style>
</head>
<body class="bg-FAF8F5" data-page-permission="ADMIN_ONLY">
<div
        class="relative flex size-full min-h-screen flex-row group/design-root overflow-x-hidden"
>
    <!-- 사이드바 -->
    <aside class="sidebar w-64 flex-shrink-0 flex flex-col space-y-2 py-6 px-4">
        <div class="flex items-center gap-3 px-3 mb-6">
            <div class="size-8 text-orange-500">
                <svg fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                    <path d="M32.9392 10.7307C32.0655 10.4106 31.134 10.2503 30.1954 10.2589H29.747C26.3663 10.2589 23.4064 12.0854 21.7295 14.8563C20.0527 12.0854 17.0928 10.2589 13.7121 10.2589H13.2637C12.3251 10.2503 11.3936 10.4106 10.52 10.7307C6.2872 12.3058 3.34436 16.4118 3.34436 21.1279C3.34436 27.4542 10.0706 33.2441 19.1119 38.0983C20.2683 38.7325 21.6107 39.076 22.9831 39.076C24.3555 39.076 25.6979 38.7325 26.8543 38.0983C35.8956 33.2441 42.6218 27.4542 42.6218 21.1279C42.6218 16.4118 39.679 12.3058 35.4462 10.7307H32.9392Z" fill="#F5A623"></path>
                    <path d="M34.5763 21.813C34.5763 22.2145 34.2561 22.5347 33.8546 22.5347H29.9871L24.0362 32.0712C23.8229 32.4247 23.4134 32.6305 22.9831 32.6305C22.5527 32.6305 22.1432 32.4247 21.9299 32.0712L15.9791 22.5347H12.1115C11.7101 22.5347 11.39 22.2145 11.39 21.813C11.39 21.4116 11.7101 21.0914 12.1115 21.0914H16.4973C16.8988 21.0914 17.259 21.3438 17.4148 21.7093L22.9831 30.6195L28.5513 21.7093C28.7071 21.3438 29.0673 21.0914 29.4688 21.0914H33.8546C34.2561 21.0914 34.5763 21.4116 34.5763 21.813Z" fill="white"></path>
                </svg>
            </div>
            <h2 class="text-orange-500 text-xl font-bold leading-tight tracking-[-0.015em]">
                CatDogEats <br />관리자 페이지
            </h2>
        </div>

        <nav class="flex flex-col space-y-1">
            <!-- 메인 메뉴들 -->
            <a class="sidebar-link" href="/v1/admin/dashboard" data-page="dashboard">
                <span class="material-icons-outlined sidebar-link-icon text-xl">dashboard</span>
                <span class="sidebar-link-text text-sm font-medium">대시보드</span>
            </a>

            <a class="sidebar-link" href="/v1/admin/account-management" data-page="account-management" id="accountManagementMenuItem">
                <span class="material-icons-outlined sidebar-link-icon text-xl">manage_accounts</span>
                <span class="sidebar-link-text text-sm font-medium">계정 관리</span>
            </a>

            <a class="sidebar-link" href="/v1/admin/invite" data-page="invite" id="inviteMenuItem" >
                <span class="material-icons-outlined sidebar-link-icon text-xl">person_add</span>
                <span class="sidebar-link-text text-sm font-medium">계정 생성</span>
            </a>

            <!-- 미구현 메뉴들 - 임시 비활성화 -->
            <a class="sidebar-link disabled" href="#" data-page="reports" onclick="showComingSoon('신고 관리')">
                <span class="material-icons-outlined sidebar-link-icon text-xl">report_problem</span>
                <span class="sidebar-link-text text-sm font-medium">신고 관리</span>
                <span class="coming-soon-badge">준비중</span>
            </a>

            <a class="sidebar-link disabled" href="#" data-page="notices" onclick="showComingSoon('공지사항 관리')">
                <span class="material-icons-outlined sidebar-link-icon text-xl">campaign</span>
                <span class="sidebar-link-text text-sm font-medium">공지사항 관리</span>
                <span class="coming-soon-badge">준비중</span>
            </a>

            <a class="sidebar-link disabled" href="#" data-page="faq" onclick="showComingSoon('FAQ 관리')">
                <span class="material-icons-outlined sidebar-link-icon text-xl">quiz</span>
                <span class="sidebar-link-text text-sm font-medium">FAQ 관리</span>
                <span class="coming-soon-badge">준비중</span>
            </a>

            <a class="sidebar-link disabled" href="#" data-page="inquiries" onclick="showComingSoon('1:1 문의 관리')">
                <span class="material-icons-outlined sidebar-link-icon text-xl">support_agent</span>
                <span class="sidebar-link-text text-sm font-medium">1:1 문의 관리</span>
                <span class="coming-soon-badge">준비중</span>
            </a>
        </nav>

        <!-- 하단 설정 메뉴 -->
        <div class="mt-auto pt-4 border-t border-beige-200">
            <a class="sidebar-link" href="/v1/admin/settings" data-page="settings">
                <span class="material-icons-outlined sidebar-link-icon text-xl">settings</span>
                <span class="sidebar-link-text text-sm font-medium">설정</span>
            </a>
        </div>
    </aside>

    <!-- 메인 콘텐츠 -->
    <div class="layout-container flex h-full grow flex-col">
        <!-- 헤더 -->
        <header
                class="flex items-center justify-between whitespace-nowrap border-b border-solid border-slate-200 bg-white px-6 py-3 shadow-sm"
        >
            <div class="flex items-center">
                <h1 class="accent-text text-lg font-semibold">관리자 계정 생성</h1>
            </div>
            <div class="flex flex-1 justify-end gap-6 items-center">
                <span class="text-sm accent-text">admin@catdogeats.com</span>
                <div class="user-menu">
                    <div
                            class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10 border border-slate-200 cursor-pointer"
                            style="
                  background-image: url('https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face');
                "
                            onclick="toggleUserMenu()"
                    ></div>
                    <div class="user-dropdown" id="userDropdown">
                        <a href="/v1/admin/profile" class="dropdown-item">
                            <span class="material-icons-outlined text-base mr-3">person</span>
                            프로필
                        </a>
                        <a href="/v1/admin/change-password" class="dropdown-item">
                            <span class="material-icons-outlined text-base mr-3">lock</span>
                            비밀번호 변경
                        </a>
                        <hr class="my-1 border-gray-200">
                        <form action="/v1/admin/logout" method="post" style="display: inline; width: 100%;">
                            <button type="submit" class="dropdown-item danger w-full text-left border-0 bg-transparent">
                                <span class="material-icons-outlined text-base mr-3">logout</span>
                                로그아웃
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </header>

        <!-- 메인 콘텐츠 -->
        <main
                class="px-6 md:px-10 lg:px-16 xl:px-20 flex flex-1 flex-col py-8 bg-FAF8F5"
        >
            <div class="flex flex-col w-full max-w-2xl mx-auto">
                <!-- 페이지 제목 -->
                <div class="text-center mb-8">
                    <div class="mb-4">
                        <span class="material-icons-outlined text-6xl primary-text">person_add</span>
                    </div>
                    <h1 class="text-3xl font-bold accent-text mb-2">새 관리자 초대</h1>
                    <p class="text-slate-500">
                        새로운 관리자를 시스템에 초대합니다. 이메일로 인증 링크가 발송됩니다.
                    </p>
                </div>

                <!-- 초대 카드 -->
                <div class="invite-card">
                    <!-- 알림 메시지 -->
                    <div id="alertContainer"></div>

                    <!-- 초대 폼 -->
                    <form id="inviteForm" onsubmit="handleInvite(event)">
                        <div class="space-y-6">
                            <!-- 이메일 -->
                            <div>
                                <label class="form-label" for="email">
                                    <span class="material-icons-outlined text-sm mr-2 align-middle">email</span>
                                    이메일 주소
                                </label>
                                <input
                                        type="email"
                                        id="email"
                                        name="email"
                                        class="form-input"
                                        placeholder="admin@catdogeats.com"
                                        required
                                        autocomplete="email"
                                />
                                <p class="text-sm text-slate-500 mt-2">
                                    관리자가 사용할 이메일 주소를 입력해주세요.
                                </p>
                            </div>

                            <!-- 이름 -->
                            <div>
                                <label class="form-label" for="name">
                                    <span class="material-icons-outlined text-sm mr-2 align-middle">person</span>
                                    이름
                                </label>
                                <input
                                        type="text"
                                        id="name"
                                        name="name"
                                        class="form-input"
                                        placeholder="관리자 이름"
                                        required
                                />
                                <p class="text-sm text-slate-500 mt-2">
                                    관리자의 실명을 정확히 입력해주세요.
                                </p>
                            </div>

                            <!-- 부서 -->
                            <div>
                                <label class="form-label" for="department">
                                    <span class="material-icons-outlined text-sm mr-2 align-middle">business</span>
                                    부서
                                </label>
                                <select id="department" name="department" class="form-select" required>
                                    <option value="">부서를 선택해주세요</option>
                                    <option value="DEVELOPMENT">DEVELOPMENT (개발팀)</option>
                                    <option value="CUSTOMER_SERVICE">CUSTOMER_SERVICE (고객서비스팀)</option>
                                    <option value="OPERATIONS">OPERATIONS (운영팀)</option>
                                </select>
                            </div>

                            <!-- 초대 절차 안내 -->
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <div class="flex items-start gap-3">
                                    <span class="material-icons-outlined text-blue-500 mt-0.5">info</span>
                                    <div>
                                        <h4 class="text-sm font-medium text-blue-800 mb-2">초대 절차</h4>
                                        <ol class="text-sm text-blue-700 space-y-1 list-decimal list-inside">
                                            <li>입력한 이메일로 인증 코드가 발송됩니다</li>
                                            <li>초대받은 사용자가 인증 페이지에서 코드를 입력합니다</li>
                                            <li>계정이 활성화되며 초기 비밀번호가 제공됩니다</li>
                                            <li>첫 로그인 후 비밀번호 변경이 필요합니다</li>
                                        </ol>
                                    </div>
                                </div>
                            </div>

                            <!-- 버튼 그룹 -->
                            <div class="space-y-3">
                                <button type="submit" id="inviteButton" class="invite-button">
                                    <div class="flex items-center justify-center gap-2">
                                        <div id="loadingSpinner" class="loading-spinner"></div>
                                        <span class="material-icons-outlined text-base" id="buttonIcon">send</span>
                                        <span id="buttonText">초대 이메일 발송</span>
                                    </div>
                                </button>

                                <a href="/v1/admin/dashboard" class="back-button">
                                    <span class="material-icons-outlined text-base mr-2">arrow_back</span>
                                    대시보드로 돌아가기
                                </a>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </main>
    </div>
</div>

<script>
    // 사용자 메뉴 토글
    function toggleUserMenu() {
        const dropdown = document.getElementById('userDropdown');
        dropdown.classList.toggle('active');
    }

    // 외부 클릭 시 메뉴 닫기
    document.addEventListener('click', function(event) {
        const userMenu = document.querySelector('.user-menu');
        const dropdown = document.getElementById('userDropdown');

        if (!userMenu.contains(event.target)) {
            dropdown.classList.remove('active');
        }
    });

    // 초대 처리
    async function handleInvite(event) {
        event.preventDefault();

        const email = document.getElementById('email').value.trim();
        const name = document.getElementById('name').value.trim();
        const department = document.getElementById('department').value;

        // 입력값 검증
        if (!email || !name || !department) {
            showAlert('모든 필드를 입력해주세요.', 'error');
            return;
        }

        // UI 업데이트
        setLoading(true);
        hideAlerts();

        try {
            // 서버로 초대 요청
            const response = await fetch('/v1/admin/invite', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-Requested-With': 'XMLHttpRequest'
                },
                body: JSON.stringify({
                    email: email,
                    name: name,
                    department: department
                })
            });

            const result = await response.json();

            if (response.ok && result.success) {
                // 초대 성공
                showAlert(
                    `${name}님에게 관리자 초대 이메일이 성공적으로 발송되었습니다! 이메일을 확인하여 계정을 활성화해주세요.`,
                    'success'
                );

                // 폼 초기화
                document.getElementById('inviteForm').reset();
                setLoading(false);

            } else {
                // 초대 실패
                const errorMessage = result.message || "초대 처리 중 오류가 발생했습니다.";
                showAlert(errorMessage, 'error');
                setLoading(false);
            }

        } catch (error) {
            console.error('초대 요청 중 오류:', error);
            showAlert("서버 연결에 문제가 발생했습니다. 잠시 후 다시 시도해주세요.", 'error');
            setLoading(false);
        }
    }

    // UI 헬퍼 함수들
    function setLoading(isLoading) {
        const button = document.getElementById("inviteButton");
        const buttonText = document.getElementById("buttonText");
        const buttonIcon = document.getElementById("buttonIcon");
        const spinner = document.getElementById("loadingSpinner");

        button.disabled = isLoading;
        buttonText.textContent = isLoading ? "발송 중..." : "초대 이메일 발송";
        buttonIcon.style.display = isLoading ? "none" : "block";
        spinner.style.display = isLoading ? "block" : "none";
    }

    function showAlert(message, type) {
        const alertContainer = document.getElementById('alertContainer');
        const alertClass = type === 'success' ? 'alert-success' : 'alert-error';
        const iconName = type === 'success' ? 'check_circle' : 'error';

        alertContainer.innerHTML = `
          <div class="alert ${alertClass}">
            <span class="material-icons-outlined text-base">${iconName}</span>
            <span>${message}</span>
          </div>
        `;

        // 성공 메시지는 5초 후 자동 숨김
        if (type === 'success') {
            setTimeout(() => {
                hideAlerts();
            }, 5000);
        }
    }

    function hideAlerts() {
        document.getElementById('alertContainer').innerHTML = '';
    }

    // 페이지 로드 시 권한 검증 및 초기화
    document.addEventListener('DOMContentLoaded', async function() {
        await initializeSidebar();
        // 공통 초기화 함수 호출
        const hasPermission = await initializeAdminPage('ADMIN_ONLY');

        if (hasPermission) {
            // ADMIN 권한이 있는 경우에만 폼 기능 활성화
            document.getElementById('email').focus();
        }
    });


    // 접근 제한 메시지 표시
    function showAccessDeniedMessage() {
        const inviteCard = document.querySelector('.invite-card');
        inviteCard.innerHTML = `
            <div class="text-center py-8">
                <div class="mb-4">
                    <span class="material-icons-outlined text-6xl text-red-500">block</span>
                </div>
                <h3 class="text-xl font-semibold text-red-600 mb-2">접근 권한 없음</h3>
                <p class="text-gray-600 mb-6">
                    관리자 초대 기능은 ADMIN 부서 사용자만 이용할 수 있습니다.
                </p>
                <a href="/v1/admin/dashboard" class="inline-flex items-center px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors">
                    <span class="material-icons-outlined text-sm mr-2">arrow_back</span>
                    대시보드로 돌아가기
                </a>
            </div>
        `;
    }

    // Enter 키 처리
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Enter') {
            const inviteButton = document.getElementById('inviteButton');
            if (!inviteButton.disabled) {
                handleInvite(event);
            }
        }
    });
</script>
</body>
</html>